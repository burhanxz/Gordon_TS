function w=cos_angle(A,W) %计算入射声波与单元法向向量的夹角
G1=(A(1,1)+A(2,1)+A(3,1))/3.0;
G2=(A(1,2)+A(2,2)+A(3,2))/3.0;
G3=(A(1,3)+A(2,3)+A(3,3))/3.0;
G=[G1,G2,G3];
R=W-G;
R=R/sqrt(dot(R,R));
L1=[A(1,1)-A(2,1),A(1,2)-A(2,2),A(1,3)-A(2,3)];
L2=[A(1,1)-A(3,1),A(1,2)-A(3,2),A(1,3)-A(3,3)];
n=cross(L1,L2);
n=n/sqrt(dot(n,n));
w=dot(R,n);
